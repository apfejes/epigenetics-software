'''
Created on 2013-05-21

@author: sperez
'''
# import matplotlib.pyplot as plt
from svgwrite.drawing import Drawing
from svgwrite.path import Path


def makesmoothpath(X, Y):
    d = "M" + str(X[0]) + "," + str(Y[0]) + " " + str(X[1]) + "," + str(Y[1]) + "S"
    for i in range(2, len(X)):
        d = d + (" " + str(X[i]) + "," + str(Y[i]))
    return d


def makelinepath(X, Y):
    d = "M" + str(X[0]) + "," + str(Y[0])
    for i in range(2, len(X)):
        d = d + (" " + str(X[i]) + "," + str(Y[i]))
    return d

def makeXYPlot(x, y, xLabel, yLabel, title, sampLabel = None, color = 'blue'):
    """ Make a plot from a list of x, list of y. 
    xLabel, yLabel = the labels for the x and y axis respectively
    title = the top title for the plot
    sampLabel=sample labels
    Returns the plt.Figure object created.
    --show() MUST be called after this function to display the plots!--
    """
#     plt.plot(x, y, label=str(sampLabel), color=color)
#     plt.xlabel(xLabel, fontsize=15)
#     plt.ylabel(yLabel)
#     plt.title(title, fontsize=20)
#     plt.legend()

    w = "10882763,0.038545931572 10884123,0.00890563890441 10884808,0.0146936547522 10884919,0.0222625777899 10885164,0.0108607481434 10886966,0.0206445211592 10890191,0.0203532009516 10893706,0.0026904654986 10895667,0.00506714511958 10896163,0.00739721479181 10897264,0.0147087253336 10917856,0.00316322915443 10962875,0.00122756207899 10989070,0.0117821177593 10990479,0.000411783485841 10990871,0.0321611172602 10991045,0.0116969588016 10991261,0.00760504784675 10991372,0.00908397390965 10991446,0.00137064215422 10993255,0.00179845027336 11013242,0.0174845168401 11046638,0.00372976438182 11079927,0.0185208625918 11098460,0.0130418779393 11098899,0.0112880850738 11098939,0.00658145832063 11099066,0.0158887670035 11099219,0.0288777014269 11099353,0.00101512650077 11099657,0.00041514027267 11102169,0.024520555608 11104844,0.00750920139476 11105952,0.00366913166459 11106825,0.0463821028332 11108001,0.0669267426784 11109178,0.0206929879402 12758286,0.0368701278963 14408273,0.00561020764248 14409417,0.0701411341914 14409752,0.0125071200964 14410130,0.00129117964923 14410326,0.016352287127 14410436,0.0373546416894 14410533,0.021243090194 14412667,0.028932445157 14698086,0.0273923201302 14981741,0.031161478214 14982127,0.00884585131234 14982237,0.0499232902726 14982306,0.00724023591894 14982546,0.000453622966005 15008359,0.0124176725093 15034886,0.00156352391388 15035864,0.0448156928583 15036144,0.0122403325633 15037329,0.0198053001353 15038334,0.00666635276173 15038491,0.00243355873816 15038614,0.0384403609428 15039012,0.00992348048152 15044290,0.000264367291006 15050527,0.00310227648922 15052104,0.0545518441262 15052891,0.00218504852245 15055215,0.00107387027292 15061790,0.0183645308403 15066783,0.00830048404934 15067749,0.0289415884442 15068639,0.0489325881817 15068958,0.046778308129 15069324,0.0831676407415 15069666,0.0432690416051 15070540,0.0227467489579 15074175,0.00570342284294 15077304,0.0726010334831 15077618,0.0635957756913 15078139,0.023223014478 15079308,0.00845447676374 15086501,0.00102466359799 15094249,0.0200911121707 15095705,0.032926588426 15095932,0.0581193796535 15096193,0.0293941811458 15096501,0.0318294198457 15104621,0.0142442320088 15122277,0.00225885683105 15133214,9.77426078854e-05 15134590,0.00391625825949 15134865,0.00374929412933 15135069,0.00292991210531 15135215,0.00395590729293 15135432,0.000478637639873 15137166,0.0386263780762 15141691,0.0174172983817 15146023,0.0222917828289 15148051,0.00825963751896 15149000,0.00286448608561 15171871,0.0103246981219 15195809,0.0532822972381 15198533,0.0223690329489 15199941,0.0174135724666 15207830,0.0238305619348 15218156,0.0272835436971 15221031,0.0196687274377 15264483,0.00348810762246 15308598,0.00866632014785 15309653,0.00778127496571 15309784,0.0214601030354 15310720,0.0104122613894 15331839,0.0132462553712 15352123,0.00396467563048 15352377,0.0368751458245 15352600,0.0319472267843 15352698,0.059907354035 15352818,0.00229807882123 15352893,0.0503882179227 15352948,0.00227535894058 15352969,0.0323962838564 15353430,0.00830015460448 15354018,0.00940639899219 15354170,0.00305854338254 15354743,0.00206268176161 15367824,0.0153834096612 15381758,0.0118979662758 15383388,0.0139263153558 15383653,0.000401460924194 15383725,0.000928345812137 15384130,0.00913250410158 15385310,0.0304009459806 15392248,0.0195610110933 15398995,0.0129691965313 15399618,0.00933073600518 15399812,0.00202806358731 15401003,0.000612632392787 15417436,0.00122105188399 15433603,0.00309182686903 15434805,0.0168788151509 15435735,0.00315480247949 15436290,0.0474644537566 15436593,0.0837822447004 15436967,0.0304013452322 15439942,0.0436932538433 15442836,0.0124347593551 15442982,0.00481568311685 15443622,0.00911096222261 15444779,0.00459535910181 15446957,0.0149870303632 15449535,0.0570067619205 15450884,0.00441521830596 15451266,0.00470369954952 15451346,0.000653907513157 15452169,0.0043073580367 15454067,0.026862282367 15455453,0.0630015930117 15456026,0.000862259542812 15456474,0.0023342317277 15456672,0.00146871631507 15457002,0.032210489445 15472503,0.00200927236279 15534136,0.0271305463944 15584146,0.00171405570441 15587875,0.00232581434154 15588029,0.00397878973921 15588192,0.01222204947 15588318,0.000969160492748 15588336,0.000705205611705 15588454,0.0111434332894 15588564,0.000738133394356 15588684,0.00613415422269 15588814,3.50005254609e-05 15589135,0.00227748823901 15617520,0.0434040658997 15645693,0.00633518520524 15645798,0.00558817291821 15645899,0.0205045592867 15646087,0.0417443080035 15646249,0.0143991556796 15646473,0.0367490332923 15647001,0.0339774068118 15700125,0.0100023914248 15753198,0.0289029988362 15754447,0.00014956673589 15755414,0.0116274536355 15755450,0.00548067682607 15755495,0.00179191594174 15755547,0.00287391528085 15755582,0.00907012741988 15755625,0.00408405058428 15755674,0.00392610060277 15755793,0.0025005805184 15755908,0.0202298640255 15755998,0.0342934477338 15756073,0.00705036835959 15756103,0.0047980767654 15835262,0.0287655072383 16125106,0.131206980353 16336491,0.0144874734404 16338898,0.0070427815747 16340648,0.0110345216284 16387344,0.0147622844049 16435044,0.119102078047 16436254,0.00932543419824 16436442,0.00632974404332 16436555,0.00288864810342 16436976,0.000186033508818 16437294,0.00523812842317 16437510,0.0029686471029 16437729,0.00164082336354 16437953,0.00201591488226 16439293,0.00586212673279 16769338,0.0117412996424 17099311,0.0269486549572 17100663,0.000101266902921 17101439,0.00907469692418 17101927,0.00192999741687 17102326,0.0095946086008 17102827,0.00053566422455 17102969,0.00697604951679 17103870,0.00616197928301 17105475,0.0682390299718 17179129,0.129627452479 17346976,0.0212886206819 17442185,0.0105254169326 17442565,0.011954910881 17442733,0.0437844467661 17504008,0.0275403888041 17565331,0.0140381622011 17565915,0.0673231755531 17738698,0.0926151210414 17911199,0.0222781363507 17911535,0.148265854082 17911823,0.10315519409 17936271,0.00855189634167 17961135,0.0894796021299 17961758,0.0338229985418 17961912,0.00475082136843 17962060,0.00498096489918 18222329,0.0323431353106 18682359,0.00255311949069 18883101,0.0137447244953 18884349,0.124810414791 18884751,0.0292496594516 18884823,0.0108440644729 18884933,0.000696995572354 18885050,0.00285470472309 18885072,0.00117934834012 18885119,0.00323316477576 18885158,0.0119870809948 18885316,0.0029645682707 18885533,0.000864738138016 18885844,4.20635292492e-05 18886849,0.0135641299272 18888770,0.00103715014123 18913961,0.00997680508334 18951985,0.0986297791758 18973144,0.00915232268068 18981827,0.124183696496 18983549,0.102484946252 18983854,0.00174184552911 18984019,0.0103324808345 18984188,0.000660133712196 18984507,0.00738928227526 18984993,0.000430536315034 18985323,0.000451937271043 18985384,0.00205993769941 18985498,0.000199196408446 18985614,0.00790993598379 18985630,0.00459696704132 18985676,0.0044788105984 18986531,0.0241981193735 18987797,0.00647246113371 19019331,0.0133713986151 19107031,0.00957135419987 19176268,0.00315945769643 19189735,0.032631793114 19190812,0.00662121953162 19191158,0.00234363869413 19191426,0.00562645091876 19191707,0.00304414844744 19191838,0.00336563553899 19191854,0.0293687814303 19191922,0.00221057732581 19192058,0.0180033446675 19192516,0.00341046771325 19194026,0.00933270294976 19213360,0.00953982098154 19244800,0.0651846667479 19258150,0.0326441132939 19436186,0.00542187123842 19615331,0.00343966412828 19616720,0.00235665411957 19616930,0.00459761956834 19617030,0.000273337279472 19617117,0.000803322186635 19617267,0.0160576241448 19617607,0.000190482770451 19617931,0.000701797321797 19628758,0.0101848235938 19753451,0.0542474284288 20166869,0.030911612496 20499897,0.0425496249983 21245378,0.00788975788014 22066139,0.00117947502906 22175236,0.0314431428169 22271384,0.0593976049197 22368118,0.1129040932 22369125,0.030901193653 22369397,0.0648972720699 22369643,0.0125854045851 22369855,0.00255192400738 22369952,0.00180729159271 22370116,0.00347546409803 22370267,0.0189830327334 22370346,0.00594997535252 22370539,0.0122305677794 22370696,0.00364526829347 22370761,0.00198665244192 22371522,0.0137550637884 22372635,0.00814766595797 23060022,0.00492254943866 24664953,0.0954626909884 26120780,0.0116842995118 26695788,0.0223809234484 26733215,0.00338058841712 26733812,0.00852890792679 26734223,0.017665153325 26734359,0.0136274300205 26735056,0.0056268718784 26769377,0.00392767158318 26866884,0.00145999570861 26932149,0.0162997143617 26933850,0.072436257864 26934260,0.0102821858504 26934378,0.00795122004519 26934394,0.00059547616566 26934466,0.00292631267098 26934580,0.00087818381076 26934759,0.000615604485752 26936721,0.00501424398791 26942211,0.0888334211959 26945991,0.0174088799163 26950664,0.230025236188 26955552,0.0169022969892 26966041,0.00366831526004 26977570,0.00593557855202 26979364,0.0177343392094 26979814,0.00408840587286 26979852,0.000313187418562 26979993,0.00263584933777 26980132,0.00665092868393 26980243,0.00771858935217 26982155,0.0103214754369 26996525,0.00331750894408 27009601,0.020347347708 27010378,0.00775765117625 27010867,0.00387099466372 27011237,0.00544970983628 27011399,0.00337838339739 27011422,0.00830481925494 27011432,0.00156671590504 27011586,0.000263208917624 27011741,0.00346345368071 27011828,0.0101989284912 27011989,0.000905154610477 27012120,0.0131540874914 27012220,0.000676038819194 27012415,0.000848342547588 27012722,0.000144405591392 27014281,0.00778413242649 27051325,0.00334878366986 27091915,0.0263703090816 27098960,0.0237117402696 27102785,0.00566205657019 27105452,0.100915918973 27106566,0.00566617640682 27106835,0.00291770715711 27106940,0.0170506985854 27106964,0.00654000518799 27107097,0.00247504642903 27107327,0.029326836841 27107591,1.12119110764e-05 27107757,0.00539780506824 27107871,0.0393489188138 27107979,0.00354070265478 27108095,0.00348716882342 27108233,0.00345603763444 27108369,0.0052482032098 27108609,0.00101920081801 27108758,0.0008127765392 27110052,0.00493139808376 27115969,0.0145950954388 27174345,0.0391849301753 27241025,0.00173905743608 27275704,0.0116798025276 27326063,0.00640959853574 27363515,0.0266701782072 27372341,0.0763074787239 27372378,0.0803495085496 27372428,0.069511155627 27455208,0.074751690282 27539013,0.146531337163 27540113,0.0444438004025 27540424,0.063742915491 27541261,0.0832180805977 27542272,0.00501472856188 27542746,0.000371390443287 27542918,0.0172384946258 27543083,0.0014897345186 27543175,0.0028772148945 27543289,0.000559755887889 27543380,0.00112208803919 27543441,0.000888241570808 27543573,0.00495702234278 27544847,0.0362589645518 27692449,0.00852173952747 27886662,0.0237651989605 27938626,0.029072883994 27943241,0.0860075936705 27944108,0.150933269023 27944632,0.203480232403 27944926,0.0701334655847 27945243,0.00611089996262 27945510,0.0173532839554 27945749,0.025419693299 28077404,0.0135801842855 28210860,0.0290445088584 28213840,0.0942216562438 28215067,0.087778475215 28215588,0.113141033208 28216240,0.00961639608357 28216760,0.00359130312674 28217343,0.00114587003877 28217705,0.00070955590315 28218108,0.00923154277734 28218538,0.000437444925914 28218692,0.00182580060791 28218873,0.00892661081646 28219147,0.00516076537987 28277153,0.00695435552386 28335432,0.0726121186189 28336037,0.0246318010584 28336538,0.00280927988472 28337032,0.00682090777281 28337381,0.00593034397851 28337700,0.0246016812432 28337813,0.0847918632272 28338302,0.0757999102713 28339024,0.00308752700558 28339273,0.004441634032 28339355,0.00681580407471 28339432,0.00172114930936 28339439,0.000376147111739 28339573,0.00301282226868 28339708,0.037265274788 28339808,0.00269085489679 28339998,0.00389413090074 28340172,0.0105869592321 28427290,0.113554382722 28515069,0.00611541724554 28515915,0.0211899968957 28516078,0.0185088365659 28723759,0.0318877127495 29012266,0.0225878730549 29096265,0.0131980289427 29241828,0.0214644197644 29384641,0.00324897660693 29388341,0.00222389917008 29391698,0.00675906823317 29527184,0.0189116667158 29786504,0.00393605219318 29910561,0.0126940583681 29911258,0.00933444910422 30049987,0.0369968070905 30216429,0.0614810109591 30249447,0.113535224541 30255773,0.00920289459976 30257341,0.0213202052405 30257516,0.0032547848872 30257702,0.00109413089955 30257765,0.00457112070543 30259622,0.00478080620713 30282066,0.00920389717902 30332321,0.0398195224578 30362755,0.150518178359 30364185,0.0164103760927 30364946,0.00732610006233 30365075,0.0150525840595 30365139,0.00732575603298 30365234,0.00441798188683 30365302,0.012211897764 30365326,0.0101013038108 30365344,0.000434951340634 30365406,0.00747456500538 30365650,0.00700126749562 30365911,0.0325592191222 30366093,0.0264154700291 30367243,0.0135044639738 30371132,0.0119351199072 30374363,0.00211016673795 30374917,0.0210321240809 30375156,0.00352613974701 30377057,0.0156561685877 30383965,0.0175569163522 30389730,0.00105623304286 30390875,0.0218423079735 30391448,0.0119439826033 30391571,0.0101597344501 30391663,0.00299244212722 30391765,0.0011065962948 30391986,0.025435776982 30392203,0.0942900944521 30392229,0.000658865963855 30392538,0.0255892119784 30393048,0.00385277110693 30394779,0.015327775146 30396443,0.00884442794675 30396667,0.0315178974848 30396756,0.000170002818389 30396860,0.00480249295692 30396996,0.00485609819125 30397067,0.00212497566186 30397169,0.00179253780084 30397324,0.00196119823757 30397553,0.00220431811762 30419851,0.00715567068358 30442778,0.0013456334795 30444428,0.00561053400508 30445520,0.00275897734769 30445811,0.00024649841036 30445929,0.00747950728195 30446012,0.000237967209205 30446112,0.00579919300045 30446182,0.00767157105193 30446214,0.00677017880488 30447851,0.0134669961717 30450431,0.018389231117 30451483,0.089602798595 30451920,0.117413171781 30452542,0.00756388158518 30452863,0.0982220289182 30454240,0.117903911474 30486728,0.0115009642871 30532565,0.0988146915809 30556437,0.0601495232615 30565637,0.0100549410938 30565672,0.000143385014161 30616528,0.0166002958806 30668883,0.00424496578823 30670642,0.0525248084518 30670871,0.00749062288225 30670908,0.00391080723544 30671012,0.00183324095038 30671088,0.00140643763843 30671100,0.00380631584584 30671107,0.0025621104197 30671217,0.00337613160896 30671500,0.00103086534568 30671677,0.00115929228707 30671681,0.00067183151395 30671688,0.000570152446234 30671701,0.00476057880663 30671775,0.00111884052922 30673458,0.00251481594385 30675630,0.102491317696 30676377,0.00202159024342 30676846,0.0214221579714 30695169,0.110273212191 30748084,0.0198754564297 30951123,0.0283614580169 31119889,0.00537428019315 31215496,0.114651793557 31310556,0.00658424713082 31310737,0.0553886851921 31311103,0.00457805978115 31311542,0.010265435353 31311769,0.00352764721878 31311941,0.00504414833668 31312184,0.0029861596789 31312280,0.00875723573155 31312409,0.0136944361367 31312564,0.00702102956734 31312724,0.00585661707927 31314402,0.00595086946692 31427224,0.012626529758 31538606,0.00808369907022 31538854,0.0182201840627 31539026,0.134756708282 31539630,0.120908047974 31563882,0.00512144602531 31587841,0.0122934394186 31588238,0.0164103595656 31588507,0.134741422268 31621333,0.157121922663 31654424,0.00647040609684 31655027,0.044984704846 31655288,0.0369635808926 31655484,0.00484974615669 31655713,0.00395370562131 31655877,0.0574242856743 31658831,0.140484360853 31661864,0.00414482344648 31662632,0.0676668389501 31677338,0.0172677658745 31691913,0.029764063747 31692484,0.00394511902861 31693205,0.0228851965169 31701748,0.00611229582052 31709848,0.0296534373695 31710058,0.00937153884797 31710318,0.0089691003273 31710720,0.000689122444763 31715849,0.0159686580784 31720907,0.038700735798 31721465,0.0125919052503 31732958,0.0382734729176 31744146,0.0194189449561 31744432,0.0038354868754 31744567,0.0209640751347 31755759,0.0224742859188 31767072,0.0221137532176 31767359,0.00759781277693 31767882,0.0189642044571 31768290,0.0401982827013 31768493,0.016753744823 31783304,0.0520349130808 31798084,0.0777260501598 31798663,0.0355170352477 31799169,0.0190477090968 31800683,0.0106198751886 31802474,0.0884206480395 31806977,0.0438776126288 31811839,0.00403915831889 31812789,0.0136684967714 31832764,0.0433796126311 31852623,0.0125918956857 31856176,0.025029758886 31861824,0.00160524625706 31864091,0.012358286273 31864233,0.010919756438 31864784,0.0149307331839 31867313,0.00236512755266 31869411,0.0203120090863 31871812,0.00156977766015 31874317,0.0121502028736 31874925,0.0311872338145 31875524,0.00592244717487 31875693,0.00373845710546 31894835,0.00775828870592 31914216,0.0153571971802 31924005,0.00144067297029 31948705,0.0177141466199 31964258,0.000159013284184 31964641,0.0183489280703 31964671,0.0119492860571 31964735,0.0116023410385 31967836,0.00838426007129 31970926,0.0246986535193 31970986,0.00454236590106 31971740,0.0144382638234 31972552,0.00183027538995 31972767,0.0351557064278 31972918,0.0176438427478 31979453,0.0170253124771 31986981,0.00668202914722 31988297,0.00751064694894 31990436,0.0806667987798 31999923,0.00166834722688 32010722,0.000404160679381 32014257,0.00690038787323 32014677,0.0106049521105 32014963,0.0132069695455 32053894,0.0241196213305 32105933,0.0111077554711 32123977,0.0255799950693 32128652,0.00541190804575 32128704,0.00803372875195 32128880,0.0384934201047 32157170,0.0178656965256 32185348,0.0496597424585 32185470,0.0287998224359 32193768,0.00157628026914 32202026,0.0340321502827 32202163,0.00537648117518 32227720,0.121828968034 32253394,0.0217254930803 32253646,0.0309625189014 32253812,0.0372857625792 32254012,0.0474615531743 32254586,0.0372475128892 32255187,0.00104951841643 32332896,0.0135319007997 32410540,0.000681460504522 32411395,0.00166618041129 32451593,0.00163012747607 32556512,0.0216745489218 32622964,0.0452061907202 32623998,0.00673948865407 32624101,0.0122940491835 32624190,0.0431227808484 32624289,0.00188970034017 32624512,0.000558874210733 32625956,0.00565667615184 32669985,0.00729288717278 32714410,0.0322924477724 32716180,0.00142805043714 32716401,0.00385451350963 32716509,0.00345090847945 32718257,0.00153876063485 32797204,0.0665564299708 32900695,0.13558310107 32927654,0.112720319365 32929083,0.045463874092 32929913,0.0356443036766 32930047,0.0108087062846 32930256,0.00148787156745 32930474,0.00518178768775 32930732,0.00138758715071 32930985,0.00525930111583 32931205,0.000672854537313 32931424,0.00174580108276 32931601,0.000745707995575 32931809,0.00283632007381 32931951,0.0085757881535 32932044,0.0308140267138 32932145,0.00862374161294 32933881,0.0021377265536 32982592,0.00217331981148 33030209,0.0040791012117 33031061,0.00727152698835 33031513,0.0839926115293 33031717,0.0039024592355 33031753,0.000233966515026 33031772,0.00129263687334 33031813,0.000120861098632 33031875,0.00784136207829 33031927,0.000586065605921 33031950,0.00233763711505 33032038,4.82882313429e-05 33032387,0.00192293287952 33033809,0.00735026391122 33039294,0.0359389684631 33072249,0.00884376641311 33101708,0.0323728249129 33103107,0.0361193100779 33103815,0.00112335924699 33104096,0.0120148098894 33104243,0.0016837342439 33104558,0.00222048327218"
    print w
    x = [float(item.split(","))[0] / 1000 for item in w.split(" ")]
    y = [round(float(item.split(",")[1]) * 100, 3) for item in w.split(" ")]

    # Drawing a methylation plot
    gene = Drawing("SVGs/methylation.svg", size = ("40000mm", "5000mm"), viewBox = ('0 0 10000 2000'), preserveAspectRatio = "xMinYMin meet")

    # d is the list of coordinates with commands such as
    # M for "move to' to initiate curve and S for smooth curve
    d = makesmoothpath(x, y)
    gene.add(Path(stroke = color, fill = "none", d = d))

    gene.save()
    print "The methylation data is ready to be viewed."
